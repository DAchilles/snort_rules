alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Axway SecureTransport XML external entity injection attempt"; flow:to_server,established; content:"/myself/resetPassword"; fast_pattern:only; http_uri; content:"<resetPassword>"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-14277; classtype:web-application-attack; sid:54003; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Tableau XML external entity injection attempt"; flow:to_server,established; content:"extensionManifestContents"; fast_pattern:only; http_client_body; content:"workgroup_session_id="; nocase; http_cookie; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-15637; reference:url,community.tableau.com/community/security-bulletins/blog/2019/08/22/important-adv-2019-030-xxe-vulnerability-in-tableau-products; classtype:web-application-attack; sid:51842; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Tableau XML external entity injection attempt"; flow:to_server,established; content:"extensionManifestContents"; fast_pattern:only; http_client_body; content:"workgroup_session_id="; nocase; http_cookie; content:"DOCTYPE"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)DOCTYPE((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-15637; reference:url,community.tableau.com/community/security-bulletins/blog/2019/08/22/important-adv-2019-030-xxe-vulnerability-in-tableau-products; classtype:web-application-attack; sid:51841; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Dell EMC Data Protection Advisor XML external entity injection attempt"; flow:to_server,established; content:"/apollo-api/idlist"; fast_pattern:only; http_uri; content:"DOCTYPE"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)DOCTYPE((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11048; reference:url,seclists.org/fulldisclosure/2018/Aug/5; classtype:web-application-attack; sid:51803; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Dell EMC Data Protection Advisor XML external entity injection attempt"; flow:to_server,established; content:"/apollo-api/idlist"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11048; reference:url,seclists.org/fulldisclosure/2018/Aug/5; classtype:web-application-attack; sid:51802; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Axway SecureTransport XML external entity injection attempt"; flow:to_server,established; content:"/myself/resetPassword"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,community.axway.com/s/article/SecureTransport-Security-Notice; classtype:web-application-attack; sid:51292; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle-BI convert servlet XML external entity injection attempt"; flow:to_server,established; content:"/xmlpserver/convert"; fast_pattern:only; http_uri; content:"xml="; nocase; http_uri; content:"ENTITY"; nocase; http_uri; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-2767; classtype:web-application-attack; sid:50773; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP CyberArk Enterprise Password Vault XML external entity injection attempt"; flow:to_server,established; content:"/PasswordVault/auth/saml"; fast_pattern:only; http_uri; content:"SAMLResponse="; nocase; base64_decode:bytes 250,relative; base64_data; content:"ENTITY"; nocase; pcre:"/\x21ENTITY[^>]{0,243}?(SYSTEM|PUBLIC)/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-7442; classtype:web-application-attack; sid:50733; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP CyberArk Enterprise Password Vault XML external entity injection attempt"; flow:to_server,established; content:"/PasswordVault/auth/saml"; fast_pattern:only; http_uri; content:"SAMLResponse="; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-7442; classtype:web-application-attack; sid:50732; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,9500,9502] (msg:"SERVER-WEBAPP Oracle Business Intelligence and XML Publisher XML external entity injection attempt"; flow:to_server,established; content:"/xmlpserver/ReportTemplateService.xls"; fast_pattern:only; http_uri; content:"DOCTYPE"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)DOCTYPE((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-2616; reference:url,www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html; classtype:web-application-attack; sid:49899; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Email Encryption Gateway XML external entity injection attempt"; flow:to_server,established; content:"/configuration.jsp"; fast_pattern:only; http_uri; content:"pciExceptionXml"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-6225; classtype:web-application-attack; sid:47798; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Openfire userimportexport plugin XML external entity injection attempt"; flow:to_server,established; content:"/plugins/userimportexport/import-user-data.jsp"; fast_pattern:only; http_uri; content:"thefile"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-2815; reference:url,www.talosintelligence.com/reports/TALOS-2017-0316/; classtype:web-application-attack; sid:42290; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Zend Technologies Zend Framework heuristicScan XML external entity injection attempt"; flow:to_server,established; content:"E|00|N|00|T|00|I|00|T|00|Y"; nocase; http_client_body; content:"S|00|Y|00|S|00|T|00|E|00|M"; within:50; fast_pattern; nocase; http_client_body; pcre:"/(\x00\x21\x00|\x00%\x002\x001\x00)E\x00N\x00T\x00I\x00T\x00Y((?!\x00\x3e\x00|\x00%\x003\x00e\x00).)*?S\x00Y\x00S\x00T\x00E\x00M/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,76117; reference:cve,2015-5161; classtype:web-application-attack; sid:36895; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Zend Technologies Zend Framework heuristicScan XML external entity injection attempt"; flow:to_server,established; content:"E|00|N|00|T|00|I|00|T|00|Y"; nocase; http_client_body; content:"P|00|U|00|B|00|L|00|I|00|C"; within:50; fast_pattern; nocase; http_client_body; pcre:"/(\x00\x21\x00|\x00%\x002\x001\x00)E\x00N\x00T\x00I\x00T\x00Y((?!\x00\x3e\x00|\x00%\x003\x00e\x00).)*?P\x00U\x00B\x00L\x00I\x00C/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,76117; reference:cve,2015-5161; classtype:web-application-attack; sid:36894; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8980 (msg:"SERVER-WEBAPP OpenNMS XML external entity injection attempt"; flow:to_server,established; content:"POST /opennms/rtc/post"; depth:22; nocase; content:"ENTITY"; nocase; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/i"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-0975; classtype:web-application-attack; sid:33896; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP McAfee ePolicy Orchestrator XML external entity injection attempt"; flow:to_server,established; content:"/core/orionUpdateTableFilter.do"; fast_pattern:only; http_uri; content:"conditionXML"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,71881; reference:cve,2015-0921; classtype:web-application-attack; sid:33279; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,8443] (msg:"SERVER-WEBAPP Symantec Endpoint Protection Manager Unauthenticated XML External Entity Injection attempt"; flow:to_server,established; content:"/servlet/ConsoleServlet"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2013-5014; reference:cve,2013-5015; classtype:attempted-user; sid:29979; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Microsoft SharePoint Server XML external entity injection attempt"; flow:to_server,established; content:"/_catalogs/wp/"; fast_pattern:only; http_uri; content:"|2E|webpart"; nocase; http_uri; content:"PUT"; http_method; content:"ENTITY"; nocase; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2021-24072; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-24072; classtype:web-application-attack; sid:57108; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree XML external entity injection attempt"; flow:to_server,established; content:"/webapp/ProductTree/ProductTree"; fast_pattern:only; http_uri; content:".aspx"; nocase; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58307; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET IntegrationXMLProcessorServlet Write XML external entity injection attempt"; flow:to_server,established; content:"/Integration/Write"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58302; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree_RightWindow XML external entity injection attempt"; flow:to_server,established; content:"/ProductTree_RightWindow.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:web-application-attack; sid:58285; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager DeploymentPlan_Event_Handler XML external entity injection attempt"; flow:to_server,established; content:"/webapp/Updates/DeploymentPlan/DeploymentPlan_Event_Handler.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:web-application-attack; sid:58333; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP MailEnable Enterprise Premium unauthenticated XML external entity injection attempt"; flow:to_server,established; content:"/http-bind/"; fast_pattern:only; http_uri; urilen:11; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2019-12924; classtype:web-application-attack; sid:58354; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET IntegrationXMLProcessorServlet UpdateProblemTickets XML external entity injection attempt"; flow:to_server,established; content:"/Integration/UpdateProblemTickets"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58352; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET MagnumEmulator Servlet XML external entity injection attempt"; flow:to_server,established; content:"/MMS"; fast_pattern:only; http_uri; urilen:4; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58374; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET XmlAdapterServlet XML external entity injection attempt"; flow:to_server,established; content:"/foglight-xml-adapter/tree-data"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58395; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager TreeUserControl_process_tree_event XML external entity injection attempt"; flow:to_server,established; content:"/webapp/TreeUserControl_process_tree_event.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58474; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET IntegrationXMLProcessorServlet AlarmActions XML external entity injection attempt"; flow:to_server,established; content:"/Integration/AlarmActions"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58517; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP SAP NetWeaver AS JAVA XML external entity injection attempt"; flow:to_server,established; content:"/sap.com~tc~bpem~him~uwlconn~provider~web/bpemuwlconn"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-9563; classtype:web-application-attack; sid:58516; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree_LeftWindow XML external entity injection attempt"; flow:to_server,established; content:"/ProductTree_LeftWindow.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58545; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Citrix StoreFront Server XML external entity injection attempt"; flow:to_server,established; content:"/Citrix/StoreAuth/ExplicitForms/Start"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-13608; classtype:web-application-attack; sid:58605; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree_TreeManagement1 XML external entity injection attempt"; flow:to_server,established; content:"/ProductTree_TreeManagement1.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58669; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET Servlet XML external entity injection attempt"; flow:to_server,established; content:"/catalyst-glue-service/message"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58710; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager AdHocQuery_Result XML external entity injection attempt"; flow:to_server,established; content:"/AdHocQuery_Result.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58840; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP F5 BIG-IP Enterprise Manager XML entity injection attempt"; flow:to_server,established; content:"!ENTITY%20%25%20remote%20SYSTEM%20%22http"; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2014-6032; classtype:attempted-user; sid:32547; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP F5 BIG-IP Enterprise Manager XML entity injection attempt"; flow:to_server,established; content:"!ENTITY % remote SYSTEM |22|http"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2014-6032; classtype:attempted-user; sid:32546; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; depth:4; nocase; content:"/xmlrpc.php"; within:50; fast_pattern; nocase; content:"<methodCall><methodName>"; within:500; nocase; content:"<params><param><value>"; within:100; nocase; content:"echo"; within:500; nocase; content:"|60|"; within:100; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921; classtype:attempted-admin; sid:33632; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><name>"; distance:0; http_client_body; content:"'|29 3B|echo|28|'"; distance:0; http_client_body; content:"'|29 3B| passthru|28|chr|28|"; distance:0; http_client_body; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921; classtype:attempted-admin; sid:13816; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><value><name>"; distance:0; http_client_body; content:"',''|29 29 3B|echo '_begin_|0A|'|3B|echo"; distance:0; http_client_body; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921; classtype:attempted-admin; sid:13817; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP PHP alternate xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><value><string></string></value></param><param><value><string>"; distance:0; http_client_body; content:"AND ascii|28|substring|28|pass,1,1|29 29 0A|/**/BETWEEN/**/52/**/AND/**/58|29|/*"; http_client_body; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14088; reference:cve,2005-1921; classtype:attempted-admin; sid:13818; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Mantis Bug Tracker XmlImportExport plugin PHP code injection attempt"; flow:to_server,established; content:"/plugin.php"; nocase; http_uri; content:"page=XmlImportExport"; fast_pattern:only; http_uri; content:"<description"; nocase; http_client_body; pcre:"/<description[^>]*?>[^<]*?(eval|exec|passthru|proc_open|shell_exec|system)/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,70993; reference:cve,2014-7146; classtype:attempted-admin; sid:32581; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Mantis Bug Tracker XmlImportExport plugin PHP code injection attempt"; flow:to_server,established; content:"/plugin.php"; nocase; http_uri; content:"page=XmlImportExport"; fast_pattern:only; http_uri; content:"issuelink"; nocase; http_client_body; pcre:"/issuelink\s*?=\s*?[\x22\x27][^\x22\x27]*?(eval|exec|passthru|proc_open|shell_exec|system)/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,70993; reference:cve,2014-7146; classtype:attempted-admin; sid:32582; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"DELETED SERVER-WEBAPP SonicWall GMS XML set_time_config command injection attempt"; flow:to_server,established; content:"set_time_config"; fast_pattern:only; http_client_body; content:"<string"; nocase; http_client_body; pcre:"/<string[^>]*>[^<]*[\x60\x3b\x7c\x26\x28]/Pi"; reference:cve,2018-9866; classtype:web-application-attack; sid:47862; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21009 (msg:"SERVER-WEBAPP Dell SonicWall GMS set_dns XMLRPC method command injection attempt"; flow:to_server,established; content:"<methodName"; nocase; content:"set_dns"; fast_pattern:only; content:"<string"; nocase; pcre:"/<string[^>]*?>[^<]*?([\x60\x3b\x7c\x26]|\x24\x28)/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,support.software.dell.com/product-notification/207447; classtype:web-application-attack; sid:39742; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-WEBAPP Dell SonicWall GMS set_time_config XMLRPC method command injection attempt"; flow:to_server,established; content:"<methodName"; nocase; content:"set_time_config"; fast_pattern:only; content:"<string"; nocase; pcre:"/<string[^>]*?>[^<]*?([\x60\x3b\x7c\x26]|\x24\x28)/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-9866; reference:url,support.software.dell.com/product-notification/207447; classtype:web-application-attack; sid:39743; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"POLICY-OTHER Microsoft Word document with large docProps/core.xml file"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; content:"docProps/core.xml"; within:17; distance:42; content:"|11 00|"; within:2; distance:-35; byte_test:4,>,2000,-6,relative, little; metadata:service ftp-data, service http, service imap, service pop3; reference:url,en.wikipedia.org/wiki/Macro_virus; classtype:policy-violation; sid:41761; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY-OTHER Microsoft Word document with large docProps/core.xml file"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; content:"docProps/core.xml"; within:17; distance:42; content:"|11 00|"; within:2; distance:-35; byte_test:4,>,2000,-6,relative, little; metadata:service smtp; reference:url,en.wikipedia.org/wiki/Macro_virus; classtype:policy-violation; sid:41762; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache WebDAV mod_dav nested entity reference DoS attempt"; flow:to_server,established; content:"PROPFIND"; http_method; content:"<?xml"; depth:200; nocase; content:"<!DOCTYPE"; distance:0; nocase; content:"["; within:50; content:"<!ENTITY"; distance:0; nocase; content:!"]"; within:500; content:"<REMOTE"; distance:0; nocase; pcre:"/^>.*?&x\d+\x3B.*?<\/REMOTE>/smiR"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,35253; reference:cve,2009-1955; classtype:attempted-dos; sid:23779; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle XSQLConfig.xml access"; flow:to_server,established; content:"/XSQLConfig.xml"; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,4290; reference:cve,2002-0568; reference:nessus,10855; classtype:web-application-activity; sid:1871; rev:12;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"DELETED INDICATOR-COMPROMISE Win.Trojan.Bedep variant outbound connection"; flow:to_server,established; content:"/stats/eurofxref/eurofxref-hist-90d.xml"; http_uri; content:"Host|3A 20|www.ecb.europa.eu|0D 0A|"; fast_pattern:only; http_header; classtype:trojan-activity; sid:33188; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"POLICY-OTHER FreeSWITCH mod_xml_rpc default credential login detected"; flow:to_server,established; content:"Authorization|3A| Basic ZnJlZXN3aXRjaDp3b3Jrcw=="; fast_pattern:only; http_header; metadata:policy security-ips alert, service http; reference:cve,2018-19911; reference:url,freeswitch.org/confluence/display/FREESWITCH/mod_xml_rpc; classtype:policy-violation; sid:53469; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-PLUGINS Microsoft Core XML core services XMLHTTP control open method code execution attempt"; flow:to_client,established; file_data; content:"var xmlhttp=new ActiveXObject|28 22|Msxml2.XMLHTTP.4.0|22 29|"; content:"try{ xmlhttp.open|28 22 5C|0t|22|, |22|test.html|22 29 3B| } catch|28|e|29| {}|3B|"; distance:0; metadata:policy max-detect-ips drop, service http; reference:bugtraq,20915; reference:cve,2006-5745; classtype:attempted-user; sid:16090; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-WEBAPP parse_xml.cgi access"; flow:to_server,established; content:"/parse_xml.cgi"; fast_pattern:only; http_uri; metadata:ruleset community, service http; reference:bugtraq,6954; reference:bugtraq,6955; reference:bugtraq,6956; reference:bugtraq,6958; reference:cve,2003-0050; reference:cve,2003-0051; reference:cve,2003-0052; reference:cve,2003-0053; reference:cve,2003-0423; classtype:web-application-activity; sid:2085; rev:17;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-WEBAPP streaming server parse_xml.cgi access"; flow:to_server,established; content:"/parse_xml.cgi"; fast_pattern:only; metadata:ruleset community, service http; reference:bugtraq,6954; reference:bugtraq,6955; reference:bugtraq,6956; reference:bugtraq,6958; reference:cve,2003-0050; reference:cve,2003-0051; reference:cve,2003-0052; reference:cve,2003-0053; reference:cve,2003-0423; classtype:web-application-activity; sid:2086; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP VMTurbo Operations Manager directory traversal attempt"; flow:to_server,established; content:"/cgi-bin/help/doIt.cgi"; fast_pattern:only; http_uri; content:"xml_path="; nocase; http_uri; content:"../"; distance:0; http_uri; pcre:"/[?&]xml_path=[^&]*?\x2e\x2e\x2f/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,67292; reference:cve,2014-3806; classtype:attempted-admin; sid:31195; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-IIS users.xml access"; flow:to_server,established; content:"/users.xml"; nocase; http_uri; metadata:ruleset community, service http; classtype:web-application-activity; sid:1750; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY XML download detected"; flow:to_client,established; content:"Content-Type|3A|"; nocase; http_header; content:"text/xml"; within:20; fast_pattern; nocase; http_header; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert, policy security-ips alert, ruleset community, service http; classtype:misc-activity; sid:21288; rev:14;)
