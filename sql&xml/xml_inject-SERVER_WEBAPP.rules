# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Axway SecureTransport XML external entity injection attempt"; flow:to_server,established; content:"/myself/resetPassword"; fast_pattern:only; http_uri; content:"<resetPassword>"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-14277; classtype:web-application-attack; sid:54003; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Tableau XML external entity injection attempt"; flow:to_server,established; content:"extensionManifestContents"; fast_pattern:only; http_client_body; content:"workgroup_session_id="; nocase; http_cookie; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-15637; reference:url,community.tableau.com/community/security-bulletins/blog/2019/08/22/important-adv-2019-030-xxe-vulnerability-in-tableau-products; classtype:web-application-attack; sid:51842; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Tableau XML external entity injection attempt"; flow:to_server,established; content:"extensionManifestContents"; fast_pattern:only; http_client_body; content:"workgroup_session_id="; nocase; http_cookie; content:"DOCTYPE"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)DOCTYPE((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-15637; reference:url,community.tableau.com/community/security-bulletins/blog/2019/08/22/important-adv-2019-030-xxe-vulnerability-in-tableau-products; classtype:web-application-attack; sid:51841; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Dell EMC Data Protection Advisor XML external entity injection attempt"; flow:to_server,established; content:"/apollo-api/idlist"; fast_pattern:only; http_uri; content:"DOCTYPE"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)DOCTYPE((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11048; reference:url,seclists.org/fulldisclosure/2018/Aug/5; classtype:web-application-attack; sid:51803; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Dell EMC Data Protection Advisor XML external entity injection attempt"; flow:to_server,established; content:"/apollo-api/idlist"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11048; reference:url,seclists.org/fulldisclosure/2018/Aug/5; classtype:web-application-attack; sid:51802; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Axway SecureTransport XML external entity injection attempt"; flow:to_server,established; content:"/myself/resetPassword"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,community.axway.com/s/article/SecureTransport-Security-Notice; classtype:web-application-attack; sid:51292; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Oracle-BI convert servlet XML external entity injection attempt"; flow:to_server,established; content:"/xmlpserver/convert"; fast_pattern:only; http_uri; content:"xml="; nocase; http_uri; content:"ENTITY"; nocase; http_uri; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-2767; classtype:web-application-attack; sid:50773; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP CyberArk Enterprise Password Vault XML external entity injection attempt"; flow:to_server,established; content:"/PasswordVault/auth/saml"; fast_pattern:only; http_uri; content:"SAMLResponse="; nocase; base64_decode:bytes 250,relative; base64_data; content:"ENTITY"; nocase; pcre:"/\x21ENTITY[^>]{0,243}?(SYSTEM|PUBLIC)/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-7442; classtype:web-application-attack; sid:50733; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP CyberArk Enterprise Password Vault XML external entity injection attempt"; flow:to_server,established; content:"/PasswordVault/auth/saml"; fast_pattern:only; http_uri; content:"SAMLResponse="; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-7442; classtype:web-application-attack; sid:50732; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,9500,9502] (msg:"SERVER-WEBAPP Oracle Business Intelligence and XML Publisher XML external entity injection attempt"; flow:to_server,established; content:"/xmlpserver/ReportTemplateService.xls"; fast_pattern:only; http_uri; content:"DOCTYPE"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)DOCTYPE((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-2616; reference:url,www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html; classtype:web-application-attack; sid:49899; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Email Encryption Gateway XML external entity injection attempt"; flow:to_server,established; content:"/configuration.jsp"; fast_pattern:only; http_uri; content:"pciExceptionXml"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-6225; classtype:web-application-attack; sid:47798; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Openfire userimportexport plugin XML external entity injection attempt"; flow:to_server,established; content:"/plugins/userimportexport/import-user-data.jsp"; fast_pattern:only; http_uri; content:"thefile"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-2815; reference:url,www.talosintelligence.com/reports/TALOS-2017-0316/; classtype:web-application-attack; sid:42290; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Zend Technologies Zend Framework heuristicScan XML external entity injection attempt"; flow:to_server,established; content:"E|00|N|00|T|00|I|00|T|00|Y"; nocase; http_client_body; content:"S|00|Y|00|S|00|T|00|E|00|M"; within:50; fast_pattern; nocase; http_client_body; pcre:"/(\x00\x21\x00|\x00%\x002\x001\x00)E\x00N\x00T\x00I\x00T\x00Y((?!\x00\x3e\x00|\x00%\x003\x00e\x00).)*?S\x00Y\x00S\x00T\x00E\x00M/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,76117; reference:cve,2015-5161; classtype:web-application-attack; sid:36895; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Zend Technologies Zend Framework heuristicScan XML external entity injection attempt"; flow:to_server,established; content:"E|00|N|00|T|00|I|00|T|00|Y"; nocase; http_client_body; content:"P|00|U|00|B|00|L|00|I|00|C"; within:50; fast_pattern; nocase; http_client_body; pcre:"/(\x00\x21\x00|\x00%\x002\x001\x00)E\x00N\x00T\x00I\x00T\x00Y((?!\x00\x3e\x00|\x00%\x003\x00e\x00).)*?P\x00U\x00B\x00L\x00I\x00C/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,76117; reference:cve,2015-5161; classtype:web-application-attack; sid:36894; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8980 (msg:"SERVER-WEBAPP OpenNMS XML external entity injection attempt"; flow:to_server,established; content:"POST /opennms/rtc/post"; depth:22; nocase; content:"ENTITY"; nocase; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/i"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-0975; classtype:web-application-attack; sid:33896; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP McAfee ePolicy Orchestrator XML external entity injection attempt"; flow:to_server,established; content:"/core/orionUpdateTableFilter.do"; fast_pattern:only; http_uri; content:"conditionXML"; nocase; http_client_body; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,71881; reference:cve,2015-0921; classtype:web-application-attack; sid:33279; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [9090,8443] (msg:"SERVER-WEBAPP Symantec Endpoint Protection Manager Unauthenticated XML External Entity Injection attempt"; flow:to_server,established; content:"/servlet/ConsoleServlet"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2013-5014; reference:cve,2013-5015; classtype:attempted-user; sid:29979; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Microsoft SharePoint Server XML external entity injection attempt"; flow:to_server,established; content:"/_catalogs/wp/"; fast_pattern:only; http_uri; content:"|2E|webpart"; nocase; http_uri; content:"PUT"; http_method; content:"ENTITY"; nocase; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/i"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2021-24072; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-24072; classtype:web-application-attack; sid:57108; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree XML external entity injection attempt"; flow:to_server,established; content:"/webapp/ProductTree/ProductTree"; fast_pattern:only; http_uri; content:".aspx"; nocase; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58307; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET IntegrationXMLProcessorServlet Write XML external entity injection attempt"; flow:to_server,established; content:"/Integration/Write"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58302; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree_RightWindow XML external entity injection attempt"; flow:to_server,established; content:"/ProductTree_RightWindow.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:web-application-attack; sid:58285; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager DeploymentPlan_Event_Handler XML external entity injection attempt"; flow:to_server,established; content:"/webapp/Updates/DeploymentPlan/DeploymentPlan_Event_Handler.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:web-application-attack; sid:58333; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP MailEnable Enterprise Premium unauthenticated XML external entity injection attempt"; flow:to_server,established; content:"/http-bind/"; fast_pattern:only; http_uri; urilen:11; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2019-12924; classtype:web-application-attack; sid:58354; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET IntegrationXMLProcessorServlet UpdateProblemTickets XML external entity injection attempt"; flow:to_server,established; content:"/Integration/UpdateProblemTickets"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58352; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET MagnumEmulator Servlet XML external entity injection attempt"; flow:to_server,established; content:"/MMS"; fast_pattern:only; http_uri; urilen:4; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58374; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET XmlAdapterServlet XML external entity injection attempt"; flow:to_server,established; content:"/foglight-xml-adapter/tree-data"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58395; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager TreeUserControl_process_tree_event XML external entity injection attempt"; flow:to_server,established; content:"/webapp/TreeUserControl_process_tree_event.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58474; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET IntegrationXMLProcessorServlet AlarmActions XML external entity injection attempt"; flow:to_server,established; content:"/Integration/AlarmActions"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58517; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP SAP NetWeaver AS JAVA XML external entity injection attempt"; flow:to_server,established; content:"/sap.com~tc~bpem~him~uwlconn~provider~web/bpemuwlconn"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-9563; classtype:web-application-attack; sid:58516; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree_LeftWindow XML external entity injection attempt"; flow:to_server,established; content:"/ProductTree_LeftWindow.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58545; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Citrix StoreFront Server XML external entity injection attempt"; flow:to_server,established; content:"/Citrix/StoreAuth/ExplicitForms/Start"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-13608; classtype:web-application-attack; sid:58605; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager ProductTree_TreeManagement1 XML external entity injection attempt"; flow:to_server,established; content:"/ProductTree_TreeManagement1.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58669; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP GE MDS PulseNET Servlet XML external entity injection attempt"; flow:to_server,established; content:"/catalyst-glue-service/message"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-10613; classtype:web-application-attack; sid:58710; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP Trend Micro Control Manager AdHocQuery_Result XML external entity injection attempt"; flow:to_server,established; content:"/AdHocQuery_Result.aspx"; fast_pattern:only; http_uri; content:"ENTITY"; nocase; http_client_body; pcre:"/(\x21|%(25)?21)ENTITY((?!\x3e|%(25)?3e).)*?(SYSTEM|PUBLIC)/Pi"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:58840; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP F5 BIG-IP Enterprise Manager XML entity injection attempt"; flow:to_server,established; content:"!ENTITY%20%25%20remote%20SYSTEM%20%22http"; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2014-6032; classtype:attempted-user; sid:32547; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-WEBAPP F5 BIG-IP Enterprise Manager XML entity injection attempt"; flow:to_server,established; content:"!ENTITY % remote SYSTEM |22|http"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2014-6032; classtype:attempted-user; sid:32546; rev:2;)
